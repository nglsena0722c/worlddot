"use strict";(self.webpackChunkworlddot=self.webpackChunkworlddot||[]).push([[369],{54244:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(86010),l=r(67294);const n=e=>{let{className:t,title:r,children:n}=e;return l.createElement("div",{className:(0,a.Z)("px-8 flex flex-row items-center max-w-full bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700",t)},l.createElement("div",{className:"p-5"},l.createElement("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white"},r),l.createElement("p",{className:"mb-3 font-normal text-gray-700 dark:text-gray-400"},n)))}},13776:(e,t,r)=>{r.d(t,{Z:()=>a});const a="xpla137jkvee9nvc0ye6m43r336c28cvjl8z0cjtghg5vcj3w0svp4xwqxgkjnj"},22873:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(67294),l=r(88767);const n=e=>{let{children:t}=e;const r=new l.QueryClient;return a.createElement(l.QueryClientProvider,{client:r},t)}},53104:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(30826),l=r(88767);const n=e=>{const t=new a.LCDClient({chainID:"cube_47-5",URL:"https://cube-lcd.xpla.dev"});return(0,l.useQuery)("get_contract_config",(async()=>await t.wasm.contractQuery(e,{config:{}})),{staleTime:1/0,cacheTime:1/0})}},80928:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(30826),l=r(88767);const n=()=>{const e=new a.LCDClient({chainID:"cube_47-5",URL:"https://cube-lcd.xpla.dev"});return(0,l.useQuery)(["latest_block"],(async()=>(await e.tendermint.blockInfo()).block.last_commit.height),{refetchInterval:6e3,staleTime:6e3,cacheTime:6e3})}},85149:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>J,contentTitle:()=>W,default:()=>P,frontMatter:()=>Z,metadata:()=>A,toc:()=>$});var a=r(87462),l=r(67294),n=r(3905),o=r(32624),c=r(52252),s=r(27715),d=r(48764).Buffer;const{encode:i,decode:u,fromWords:m,toWords:g}=s.bech32,k=e=>{const{words:t}=u(e);return d.from(m(t)).toString("hex").toLowerCase()};var p=r(30826),b=r(88767);const f=e=>{const t=new p.LCDClient({chainID:"cube_47-5",URL:"https://cube-lcd.xpla.dev"});return(0,b.useQuery)(["get_user_balance",e],(async()=>await t.bank.balance(e).then((e=>{let[t]=e;return t.toString()}))),{staleTime:1/0,cacheTime:1/0})},h=e=>{const t=new p.LCDClient({chainID:"cube_47-5",URL:"https://cube-lcd.xpla.dev"});return(0,b.useQuery)(["lastest_dot"],(async()=>await t.wasm.contractQuery(e,{latest_dots:{}})),{refetchInterval:6e3,staleTime:6e3,cacheTime:6e3})};var y=r(86010),x=r(71393);const E=e=>{let{dot:t,color:r,clicked:a,setClicked:n}=e;const o=!("white"===t.backgroundColor||"#D9D9D9"===t.backgroundColor),c=w(t.X,t.Y,a);return l.createElement("div",{className:"relative",onClick:()=>{const e=JSON.parse(a),l=e.find((e=>e.startsWith(`{"X" : ${t.X},"Y" : ${t.Y}`)));if(void 0===l){e.push(`{"X" : ${t.X},"Y" : ${t.Y}, "backgroundColor" : "${r}", "lock" : 0}`);const a=new Set(e);n(JSON.stringify(Array.from(a)))}else{const t=e.indexOf(l);t>-1&&e.splice(t,1),n(JSON.stringify(e))}}},l.createElement("div",{className:(0,y.Z)("aspect-square","dot-popup-container z-0 border-0",o||c?"hover-opacity":"hover-gray"),style:c?{backgroundColor:r}:{backgroundColor:t.backgroundColor}}),l.createElement("div",{className:(0,y.Z)("absolute left-[100%] top-0 w-[250px] h-[150px] bg-black p-4","dot-popup z-10 border-0 text-white flex items-start justify-center flex-col")},"X : ",t.X,", Y : ",t.Y,o&&l.createElement(l.Fragment,null,l.createElement("br",null),"backgroundColor : ",c?r:t.backgroundColor),l.createElement("br",null),t.dotOwner&&l.createElement("div",null,"Owner : ",(0,x.$G)(t.dotOwner)," ",l.createElement("br",null)),t.lock_amount&&l.createElement("div",null,"Lock XPLA : ",t.lock_amount," ",l.createElement("br",null)),t.painted_block&&l.createElement("div",null,"Painted Block : ",t.painted_block," ",l.createElement("br",null))))},w=(e,t,r)=>0!==JSON.parse(r).map((e=>JSON.parse(e))).filter((r=>r.X===e&&r.Y===t)).length;var v=r(80928),N=r(54244);const C=e=>{let{configData:t,connectedWallet:r,contractAddress:a}=e;const n=t.dotcount,[s,d]=(0,l.useState)("[]"),{isLoading:i,data:u}=(0,v.Z)();(0,l.useEffect)((()=>{const e=[];for(let t=1;t<=n;t++){const r=[];for(let e=1;e<=n;e++)r.push({X:e,Y:t,backgroundColor:(e+t)%2==0?"white":"#D9D9D9"});e.push(r)}d(JSON.stringify(e))}),[]);const{data:m}=h(a);(0,l.useEffect)((()=>{if(m&&0!==m.length){const e=D(s);m.map((t=>{e[t[1].y-1][t[1].x-1]={X:t[1].x,Y:t[1].y,backgroundColor:t[1].color,dotOwner:t[1].dot_owner,lock_amount:t[1].lock?t[1].lock.amount:"0",painted_block:t[0]}})),d(JSON.stringify(e))}}),[m]);const g=r.xplaAddress,{isLoading:b,data:x}=f(g),w="#"+k(g).slice(0,6),[C,Y]=(0,l.useState)("[]"),[S,L]=(0,l.useState)(null),[_,O]=(0,l.useState)(null),{lockAmount:Z,unlockAmount:W}=X(C,s);return l.createElement(l.Fragment,null,l.createElement("div",{className:"grid gap-10 grid-cols-2"},l.createElement(N.Z,{title:"Block Info",children:l.createElement(l.Fragment,null,i?l.createElement(o.Z,null):l.createElement("div",null,"XPLA Latest Block : ",u," "),m&&0!==m.length&&l.createElement("div",null,"lastest Changed Block :"," ",Math.max(...m.map((e=>e[0])))))}),l.createElement(N.Z,{title:"User Info",children:l.createElement(l.Fragment,null,l.createElement("div",null,"Your Balance :"," ",b?l.createElement(o.Z,null):l.createElement("span",null,0===x.length?"0XPLA":(Number(x.substring(0,x.length-5))/10**18).toFixed(2)+" XPLA (Fixed : 2)")),l.createElement("div",{className:"flex items-center gap-2"},"Your Color : ",w," ",l.createElement("div",{className:"h-[20px] aspect-square",style:{border:"1px solid black",backgroundColor:w}})))}),l.createElement(N.Z,{title:"World Dot Info",className:"col-span-2",children:l.createElement("div",null,l.createElement("div",null,"Contract Address : ",a),l.createElement("div",null,"Dot Width : ",t.dotcount),l.createElement("div",null,"Lock Block Height : ",t.lock_block_height))})),l.createElement("div",{className:"mt-8 w-full aspect-square border-2 border-black-600 border-solid grid",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`}},D(s).map((e=>e.map((e=>l.createElement(E,{key:e.X+e.Y,dot:e,color:w,clicked:C,setClicked:Y})))))),l.createElement("div",{className:(0,y.Z)("mt-8 px-8 flex flex-row items-center max-w-full bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700")},l.createElement("div",{className:"p-5 w-full"},l.createElement("h5",{className:"w-full flex justify-between items-center  mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white"},l.createElement("span",null,"You clicked :"),l.createElement("button",{className:" cursor-pointer py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",onClick:()=>Y("[]")},"Reset Your Click")),l.createElement("p",{className:"mb-3 font-normal text-gray-700 dark:text-gray-400"},l.createElement("p",null,"If you want to lock, you need to pay XPLA.")),JSON.parse(C).map(((e,t)=>{const r=JSON.parse(e);return l.createElement("div",{key:t,className:"my-4"},l.createElement("div",{className:"w-full mb-4",style:{border:"1px solid gray"}}),"X: ",r.X,l.createElement("br",null),"Y : ",r.Y,l.createElement("br",null),"Lock (You need to input only number!) : "," ",l.createElement("input",{onChange:e=>{let t=Number(e.target.value)||0;const a=JSON.parse(C),l=a.find((e=>e.startsWith(`{"X" : ${r.X},"Y" : ${r.Y}`))),n=a.indexOf(l);a[n]=`{"X" : ${r.X},"Y" : ${r.Y}, "backgroundColor" : "${w}", "lock" : ${t}}`,Y(JSON.stringify(a))},value:r.lock}),l.createElement("br",null))})))),l.createElement("button",{className:"mt-8 w-full cursor-pointer py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",onClick:async()=>{const e=JSON.parse(C),t=[];for(let r of e){const e=JSON.parse(r),a=0===e.lock?null:{denom:"axpla",amount:e.lock.toString()};t.push({x:e.X,y:e.Y,color:w,dot_owner:g,lock:a,unlocked:null===a})}const l={msgs:[new p.MsgExecuteContract(g,a,{paint:{user:g,dots:t}},Z+W===0?void 0:[new p.Coin("axpla",(Z+W).toString())])]};try{const e=await r.post(l);L(e)}catch(n){n instanceof c.T$?O("User Denied"):O(`Unknown Error: ${n instanceof Error?n.message:String(n)}`)}}},l.createElement("div",null,"You will Pay : ",Z+W," ",l.createElement("span",{className:"text-[#ff0000]"},"aXPLA")," (You will unLock with"," ",W," ",l.createElement("span",{className:"text-[#ff0000]"},"aXPLA")," and Lock new Block with ",Z," ",l.createElement("span",{className:"text-[#ff0000]"},"aXPLA"),")"),"If you want to paint your dot, click this button."),S&&l.createElement(l.Fragment,null,l.createElement("div",{className:"mt-4 block rounded-lg border bg-white p-6 shadow dark:border-neutral-700 dark:bg-neutral-800 "},l.createElement("div",{className:"flex items-center justify-between gap-4"},"Result",l.createElement("a",{href:`https://explorer.xpla.io/testnet/tx/${S.result.txhash}`,target:"_blank",rel:"noreferrer"},S.result.txhash),l.createElement("span",null,_)))))},D=e=>JSON.parse(e),X=(e,t)=>{const r=JSON.parse(t),a=JSON.parse(e);let l=0,n=0;for(let o of a){const e=JSON.parse(o);n+=r[e.Y-1][e.X-1].lock_amount?Number(r[e.Y-1][e.X-1].lock_amount):0,l+=e.lock}return{lockAmount:l,unlockAmount:n}};var Y=r(53104),S=r(13776);const L=()=>{const{isLoading:e,data:t}=(0,Y.Z)(S.Z),r=(0,c.Yk)();return e?l.createElement(o.Z,null):r?l.createElement(C,{configData:t,connectedWallet:r,contractAddress:S.Z}):l.createElement("div",null,"Connect Your Wallet")};var _=r(85405),O=(r(34341),r(22873));const Z={},W="World Dot",A={unversionedId:"WorldDot",id:"WorldDot",title:"World Dot",description:"",source:"@site/docs/WorldDot.mdx",sourceDirName:".",slug:"/WorldDot",permalink:"/worlddot/docs/WorldDot",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",next:{title:"MyDot",permalink:"/worlddot/docs/MyDot"}},J={},$=[],T={toc:$},I="wrapper";function P(e){let{components:t,...r}=e;return(0,n.kt)(I,(0,a.Z)({},T,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"world-dot"},"World Dot"),(0,n.kt)(_.Z,{mdxType:"WalletWrap"},(0,n.kt)(O.Z,{mdxType:"QueryWrap"},(0,n.kt)(L,{mdxType:"Canvas"}))))}P.isMDXComponent=!0}}]);